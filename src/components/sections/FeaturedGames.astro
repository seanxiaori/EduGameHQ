---
// src/components/sections/FeaturedGames.astro
import GameCard from '../GameCard.astro';
import { t } from '../../i18n/utils';
import fs from 'fs';
import path from 'path';

export interface Props {
  translations: Record<string, any>;
}

const { translations } = Astro.props;

// 从JSON文件读取游戏数据
const gamesDataPath = path.join(process.cwd(), 'src/data/games.json');
let allGamesData = [];
try {
  const fileContent = fs.readFileSync(gamesDataPath, 'utf-8');
  allGamesData = JSON.parse(fileContent);
} catch (error) {
  console.error('❌ 无法读取游戏数据文件:', error);
}

const featuredGames = allGamesData.filter((game: any) => game.featured);
---
<section id="featured" class="featured-section">
  <div class="module-header">
    <div class="module-icon featured">
      <i class="fas fa-star"></i>
    </div>
    <div class="module-text">
      <h2 class="module-title">{t(translations, 'home.featured_games.title', 'Featured Games')}</h2>
      <p class="module-description">{t(translations, 'home.featured_games.description', 'Our most popular and recommended educational games')}</p>
    </div>
  </div>
  
  <div class="games-grid">
    {featuredGames.map((game: any) => (
      <GameCard game={game} translations={translations} showPlayHistory={true} showPopularity={true} showFavorite={true} />
    ))}
  </div>
</section>
