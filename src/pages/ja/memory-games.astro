---
import BaseLayout from '../../layouts/BaseLayout.astro';
import GameCard from '../../components/GameCard.astro';
import type { Game } from '../../types/game';
import { getTranslations, t } from '../../i18n/utils';
import fs from 'fs';
import path from 'path';

// ÂØºÂÖ•Ê†∑ÂºèÊñá‰ª∂
import '../../styles/game-card.css';

// Ëé∑ÂèñÁøªËØëÊï∞ÊçÆ
const translations = await getTranslations('ja');

// ‰ªéJSONÊñá‰ª∂ËØªÂèñÊ∏∏ÊàèÊï∞ÊçÆ
const gamesDataPath = path.join(process.cwd(), 'src/data/games.json');
let allGamesData: Game[] = [];

try {
  const fileContent = fs.readFileSync(gamesDataPath, 'utf-8');
  allGamesData = JSON.parse(fileContent) as Game[];
} catch (error) {
  console.warn('Unable to read games data file:', error);
}

// Á≠õÈÄâËÆ∞ÂøÜÊ∏∏Êàè
const memoryGames = allGamesData.filter(game => game.category === 'memory');

// ÊåâÈöæÂ∫¶ÂíåÁâπËâ≤ÂàÜÁªÑÊ∏∏Êàè
const featuredGames = memoryGames.filter(game => game.featured);
const easyGames = memoryGames.filter(game => game.difficulty === 'Easy');
const mediumGames = memoryGames.filter(game => game.difficulty === 'Medium');
const hardGames = memoryGames.filter(game => game.difficulty === 'Hard');

// üîß GEO‰ºòÂåñÔºöÁîüÊàêCollectionPageÁªìÊûÑÂåñÊï∞ÊçÆÔºàÂ∏ÆÂä©AIÁêÜËß£ÂàÜÁ±ªÈ°µÈù¢ÂíåÊ∏∏ÊàèÈõÜÂêàÔºâ
const collectionPageData = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "Memory Games Collection - EduGameHQ",
  "description": "Boost your memory and cognitive skills through play! Our collection of memory games helps improve concentration, recall, and mental agility for all ages.",
  "url": "https://www.edugamehq.com/memory-games",
  "mainEntity": {
    "@type": "ItemList",
    "numberOfItems": memoryGames.length,
    "itemListElement": memoryGames.slice(0, 12).map((game, index) => ({
      "@type": "ListItem",
      "position": index + 1,
      "item": {
        "@type": "Game",
        "name": game.title,
        "description": game.description,
        "url": `https://www.edugamehq.com/games/${game.slug}`,
        "image": game.thumbnailUrl || "/images/logo.svg",
        "genre": "Educational Memory Game",
        "educationalLevel": game.ageRange,
        "audience": {
          "@type": "EducationalAudience",
          "educationalRole": "student"
        }
      }
    }))
  },
  "about": {
    "@type": "Thing",
    "name": "Memory Training",
    "description": "Educational games focused on improving memory, concentration, and cognitive abilities through engaging gameplay"
  },
  "keywords": "memory games, brain training, concentration games, cognitive skills, memory improvement, mental agility"
};
---

<BaseLayout additionalStructuredData={collectionPageData}>
  <main class="main-content">
    <div class="content-wrapper">

      <!-- 1. È°µÈù¢È°∂ÈÉ®Âå∫Âüü -->
      <section class="page-header">
        <div class="header-content">
          <div class="header-icon">
            <div class="section-icon memory">
              <i class="fas fa-brain"></i>
            </div>
          </div>
          <div class="header-text">
            <h1 class="page-title">{t(translations, 'category_pages.memory_games.title', 'Memory Games')}</h1>
            <p class="page-description">
              {t(translations, 'category_pages.memory_games.description', 'Boost your memory and cognitive skills through play! Our collection of memory games helps improve concentration, recall, and mental agility for all ages. From simple matching games to complex pattern recognition, discover the joy of training your brain through engaging gameplay.')}
            </p>
          </div>
        </div>
      </section>

      <!-- 2. ÁâπËâ≤Ê∏∏ÊàèÊ®°Âùó -->
      {featuredGames.length > 0 && (
        <section class="game-module featured-module">
          <div class="module-header">
            <div class="module-icon featured-icon">
              <i class="fas fa-star"></i>
            </div>
            <div class="module-title-group">
              <h2 class="module-title">{t(translations, 'category_pages.memory_games.featured_section.title', 'Featured Memory Games')}</h2>
              <p class="module-subtitle">{t(translations, 'category_pages.memory_games.featured_section.description', 'Our most popular and recommended memory games')}</p>
            </div>
          </div>
          
          <div class="games-grid">
            {featuredGames.slice(0, 6).map((game) => (
              <GameCard game={game} showPlayHistory={true} showPopularity={true} showFavorite={true} />
            ))}
          </div>
        </section>
      )}

      <!-- 3. ÂÆπÊòìÈöæÂ∫¶Ê∏∏ÊàèÊ®°Âùó -->
      {easyGames.length > 0 && (
        <section class="game-module difficulty-module easy-module">
          <div class="module-header">
            <div class="module-icon easy-icon">
              <i class="fas fa-smile"></i>
            </div>
            <div class="module-title-group">
              <h2 class="module-title">{t(translations, 'category_pages.memory_games.difficulty_levels.easy.title', 'Easy Level Memory')}</h2>
              <p class="module-subtitle">{t(translations, 'category_pages.memory_games.difficulty_levels.easy.description', 'Perfect for beginners and young minds')}</p>
            </div>
          </div>
          
          <div class="games-grid">
            {easyGames.map((game) => (
              <GameCard game={game} showPlayHistory={true} showPopularity={true} showFavorite={true} />
            ))}
          </div>
        </section>
      )}

      <!-- 4. ‰∏≠Á≠âÈöæÂ∫¶Ê∏∏ÊàèÊ®°Âùó -->
      {mediumGames.length > 0 && (
        <section class="game-module difficulty-module medium-module">
          <div class="module-header">
            <div class="module-icon medium-icon">
              <i class="fas fa-meh"></i>
            </div>
            <div class="module-title-group">
              <h2 class="module-title">{t(translations, 'category_pages.memory_games.difficulty_levels.medium.title', 'Medium Level Memory')}</h2>
              <p class="module-subtitle">{t(translations, 'category_pages.memory_games.difficulty_levels.medium.description', 'Challenge yourself with intermediate memory tasks')}</p>
            </div>
          </div>
          
          <div class="games-grid">
            {mediumGames.map((game) => (
              <GameCard game={game} showPlayHistory={true} showPopularity={true} showFavorite={true} />
            ))}
          </div>
        </section>
      )}

      <!-- 5. Âõ∞ÈöæÊ∏∏ÊàèÊ®°Âùó -->
      {hardGames.length > 0 && (
        <section class="game-module difficulty-module hard-module">
          <div class="module-header">
            <div class="module-icon hard-icon">
              <i class="fas fa-frown"></i>
            </div>
            <div class="module-title-group">
              <h2 class="module-title">{t(translations, 'category_pages.memory_games.difficulty_levels.hard.title', 'Hard Level Memory')}</h2>
              <p class="module-subtitle">{t(translations, 'category_pages.memory_games.difficulty_levels.hard.description', 'Advanced challenges for memory masters')}</p>
            </div>
          </div>
          
          <div class="games-grid">
            {hardGames.map((game) => (
              <GameCard game={game} showPlayHistory={true} showPopularity={true} showFavorite={true} />
            ))}
          </div>
        </section>
      )}

      <!-- 6. Â≠¶‰π†Âª∫ËÆÆÊ®°Âùó -->
      <section class="info-module tips-module">
        <div class="module-header">
          <div class="module-icon tips-icon">
            <i class="fas fa-lightbulb"></i>
          </div>
          <div class="module-title-group">
            <h2 class="module-title">{t(translations, 'category_pages.memory_games.learning_tips.title', 'Memory Training Tips')}</h2>
            <p class="module-subtitle">{t(translations, 'category_pages.memory_games.learning_tips.subtitle', 'Expert advice to improve your memory skills')}</p>
          </div>
        </div>
        
        <div class="tips-grid">
          <div class="tip-item">
            <div class="tip-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="tip-content">
              <h4 class="tip-title">{t(translations, 'category_pages.memory_games.learning_tips.tips.0.title', 'Practice Daily')}</h4>
              <p class="tip-text">{t(translations, 'category_pages.memory_games.learning_tips.tips.0.description', 'Spend 15-20 minutes daily training your memory through games')}</p>
            </div>
          </div>
          
          <div class="tip-item">
            <div class="tip-icon">
              <i class="fas fa-chart-line"></i>
            </div>
            <div class="tip-content">
              <h4 class="tip-title">{t(translations, 'category_pages.memory_games.learning_tips.tips.1.title', 'Start Simple')}</h4>
              <p class="tip-text">{t(translations, 'category_pages.memory_games.learning_tips.tips.1.description', 'Begin with simple patterns and gradually increase complexity')}</p>
            </div>
          </div>
          
          <div class="tip-item">
            <div class="tip-icon">
              <i class="fas fa-heart"></i>
            </div>
            <div class="tip-content">
              <h4 class="tip-title">{t(translations, 'category_pages.memory_games.learning_tips.tips.2.title', 'Stay Focused')}</h4>
              <p class="tip-text">{t(translations, 'category_pages.memory_games.learning_tips.tips.2.description', 'Concentrate fully on the task to improve memory retention')}</p>
            </div>
          </div>
          
          <div class="tip-item">
            <div class="tip-icon">
              <i class="fas fa-question-circle"></i>
            </div>
            <div class="tip-content">
              <h4 class="tip-title">{t(translations, 'category_pages.memory_games.learning_tips.tips.3.title', 'Use Strategies')}</h4>
              <p class="tip-text">{t(translations, 'category_pages.memory_games.learning_tips.tips.3.description', 'Develop memory techniques like visualization and association')}</p>
            </div>
          </div>
        </div>
      </section>

      <!-- 7. Ê†∏ÂøÉÊäÄËÉΩÊ®°Âùó -->
      <section class="info-module skills-module">
        <div class="module-header">
          <div class="module-icon skills-icon">
            <i class="fas fa-brain"></i>
          </div>
          <div class="module-title-group">
            <h2 class="module-title">{t(translations, 'category_pages.memory_games.core_skills.title', 'Core Skills You\'ll Develop')}</h2>
            <p class="module-subtitle">{t(translations, 'category_pages.memory_games.core_skills.subtitle', 'Essential memory abilities gained through cognitive gameplay')}</p>
          </div>
        </div>

        <div class="skills-grid">
          <div class="skill-item">
            <div class="skill-icon">
              <i class="fas fa-eye"></i>
            </div>
            <div class="skill-content">
              <h4 class="skill-title">{t(translations, 'category_pages.memory_games.core_skills.skills.0.title', 'Visual Memory')}</h4>
              <p class="skill-description">{t(translations, 'category_pages.memory_games.core_skills.skills.0.description', 'Remember images, patterns, and spatial layouts')}</p>
            </div>
          </div>

          <div class="skill-item">
            <div class="skill-icon">
              <i class="fas fa-volume-up"></i>
            </div>
            <div class="skill-content">
              <h4 class="skill-title">{t(translations, 'category_pages.memory_games.core_skills.skills.1.title', 'Auditory Memory')}</h4>
              <p class="skill-description">{t(translations, 'category_pages.memory_games.core_skills.skills.1.description', 'Recall sounds, music, and spoken information')}</p>
            </div>
          </div>

          <div class="skill-item">
            <div class="skill-icon">
              <i class="fas fa-list-ol"></i>
            </div>
            <div class="skill-content">
              <h4 class="skill-title">{t(translations, 'category_pages.memory_games.core_skills.skills.2.title', 'Sequential Memory')}</h4>
              <p class="skill-description">{t(translations, 'category_pages.memory_games.core_skills.skills.2.description', 'Remember order and sequence of events')}</p>
            </div>
          </div>

          <div class="skill-item">
            <div class="skill-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="skill-content">
              <h4 class="skill-title">{t(translations, 'category_pages.memory_games.core_skills.skills.3.title', 'Working Memory')}</h4>
              <p class="skill-description">{t(translations, 'category_pages.memory_games.core_skills.skills.3.description', 'Hold and manipulate information temporarily')}</p>
            </div>
          </div>

          <div class="skill-item">
            <div class="skill-icon">
              <i class="fas fa-link"></i>
            </div>
            <div class="skill-content">
              <h4 class="skill-title">{t(translations, 'category_pages.memory_games.core_skills.skills.4.title', 'Associative Memory')}</h4>
              <p class="skill-description">{t(translations, 'category_pages.memory_games.core_skills.skills.4.description', 'Connect and relate different pieces of information')}</p>
            </div>
          </div>
          
          <div class="skill-item">
            <div class="skill-icon">
              <i class="fas fa-brain"></i>
            </div>
            <div class="skill-content">
              <h4 class="skill-title">{t(translations, 'category_pages.memory_games.core_skills.skills.5.title', 'Cognitive Flexibility')}</h4>
              <p class="skill-description">{t(translations, 'category_pages.memory_games.core_skills.skills.5.description', 'Adapt thinking and switch between concepts')}</p>
            </div>
          </div>
        </div>
      </section>

    </div>
  </main>
</BaseLayout>

<style>
  /* ‰∏ªË¶ÅÂÜÖÂÆπÂå∫Âüü */
  .main-content {
    width: 100%;
    background: linear-gradient(135deg, #FEFCFB 0%, #F8F6F3 50%, #FFF7ED 100%);
    min-height: 100vh;
  }

  .content-wrapper {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
  }

  /* 1. È°µÈù¢Â§¥ÈÉ®Âå∫Âüü */
  .page-header {
    background: linear-gradient(135deg, rgb(240 249 255) 0%, rgb(219 234 254) 50%, rgba(59 130 246, 0.08) 100%);
    border-radius: 20px;
    padding: 2rem;
    margin-bottom: 2.5rem;
    border: 1px solid rgba(59 130 246, 0.15);
    box-shadow: 
      0 8px 32px rgba(59 130 246, 0.08),
      0 2px 8px rgba(0, 0, 0, 0.04);
    position: relative;
    overflow: hidden;
  }

  .page-header::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 1px;
    background: linear-gradient(90deg, transparent 0%, rgba(59 130 246, 0.3) 50%, transparent 100%);
  }

  .header-content {
    display: flex;
    align-items: center;
    gap: 2rem;
  }

  .header-icon {
    flex-shrink: 0;
  }

  .section-icon {
    width: 72px;
    height: 72px;
    border-radius: 20px;
    background: linear-gradient(135deg, rgb(59 130 246) 0%, rgb(37 99 235) 50%, rgb(29 78 216) 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.75rem;
    box-shadow: 
      0 8px 24px rgba(59 130 246, 0.3),
      0 4px 12px rgba(59 130 246, 0.2);
    transition: all 0.3s ease;
  }

  .section-icon:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 
      0 12px 32px rgba(59 130 246, 0.4),
      0 6px 16px rgba(59 130 246, 0.3);
  }

  .header-text {
    flex: 1;
  }

  .page-title {
    font-size: 2.5rem;
    font-weight: 800;
    font-family: 'Space Grotesk', sans-serif;
    background: linear-gradient(135deg, rgb(59 130 246) 0%, rgb(37 99 235) 50%, rgb(29 78 216) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin: 0 0 0.5rem 0;
    line-height: 1.2;
  }

  .page-description {
    font-size: 1.125rem;
    color: #64748B;
    margin: 0;
    line-height: 1.6;
  }

  /* ÈÄöÁî®Ê®°ÂùóÊ†∑Âºè */
  .game-module,
  .info-module {
    margin-bottom: 3rem;
  }

  .module-header {
    display: flex;
    align-items: flex-start;
    gap: 1rem;
    margin-bottom: 1.5rem;
    padding: 1.5rem;
    background: white;
    border-radius: 16px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    border: 1px solid #F3F4F6;
  }

  .module-icon {
    width: 48px;
    height: 48px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 1.25rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    flex-shrink: 0;
    margin-top: 2px;
  }

  .featured-icon {
    background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
  }

  .easy-icon {
    background: linear-gradient(135deg, #10B981 0%, #059669 100%);
  }

  .medium-icon {
    background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
  }

  .hard-icon {
    background: linear-gradient(135deg, #EF4444 0%, #DC2626 100%);
  }

  .tips-icon {
    background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
  }

  .skills-icon {
    background: linear-gradient(135deg, #EC4899 0%, #DB2777 100%);
  }

  .module-title-group {
    flex: 1;
  }

  .module-title {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: #1F2937;
    margin: 0 0 0.25rem 0;
    line-height: 1.3;
  }

  .module-subtitle {
    color: #6B7280;
    font-size: 0.9rem;
    margin: 0;
    line-height: 1.4;
  }

  /* Â≠¶‰π†Âª∫ËÆÆÊ®°Âùó */
  .tips-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
  }

  .tip-item {
    background: white;
    border-radius: 12px;
    padding: 1.25rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    border: 1px solid #F3F4F6;
    transition: all 0.3s ease;
    display: flex;
    gap: 0.875rem;
    align-items: flex-start;
  }

  .tip-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    border-color: rgba(139, 92, 246, 0.2);
  }

  .tip-icon {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.875rem;
    flex-shrink: 0;
    margin-top: 1px;
  }

  .tip-content {
    flex: 1;
  }

  .tip-title {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    color: #1F2937;
    margin: 0 0 0.25rem 0;
    line-height: 1.3;
  }

  .tip-text {
    color: #6B7280;
    line-height: 1.4;
    margin: 0;
    font-size: 0.8rem;
  }

  /* Ê†∏ÂøÉÊäÄËÉΩÊ®°Âùó */
  .skills-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1rem;
  }

  .skill-item {
    background: white;
    border-radius: 12px;
    padding: 1.25rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    border: 1px solid #F3F4F6;
    transition: all 0.3s ease;
    text-align: left;
    display: flex;
    gap: 0.875rem;
    align-items: flex-start;
  }

  .skill-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    border-color: rgba(236, 72, 153, 0.2);
  }

  .skill-icon {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    background: linear-gradient(135deg, #EC4899 0%, #DB2777 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 0.875rem;
    flex-shrink: 0;
    margin-top: 1px;
    box-shadow: 0 2px 6px rgba(236, 72, 153, 0.3);
  }

  .skill-content {
    flex: 1;
  }

  .skill-title {
    font-family: 'Space Grotesk', sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    color: #1F2937;
    margin: 0 0 0.25rem 0;
    line-height: 1.3;
  }

  .skill-description {
    color: #6B7280;
    line-height: 1.4;
    margin: 0;
    font-size: 0.8rem;
  }

  /* Âä®ÁîªÊïàÊûú */
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fadeInUp {
    animation: fadeInUp 0.6s ease-out forwards;
  }

  /* ÂìçÂ∫îÂºèËÆæËÆ° */
  @media (max-width: 1024px) {
    .tips-grid {
      grid-template-columns: 1fr;
    }

    .skills-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .header-content {
      gap: 1.5rem;
    }

    .page-title {
      font-size: 2.25rem;
    }

    .page-description {
      font-size: 1rem;
    }
  }

  @media (max-width: 768px) {
    .content-wrapper {
      padding: 1rem;
    }

    .page-header {
      padding: 1.5rem;
      margin-bottom: 2rem;
      border-radius: 18px;
    }

    .header-content {
      flex-direction: column;
      text-align: center;
      gap: 1.25rem;
    }

    .header-text {
      text-align: center;
    }

    .category-icon {
      width: 64px;
      height: 64px;
    }

    .icon-background {
      width: 64px;
      height: 64px;
      font-size: 1.75rem;
      border-radius: 18px;
    }

    .icon-background::after {
      inset: 2px;
      border-radius: 16px;
    }

    .page-title {
      font-size: 2rem;
    }

    .page-description {
      font-size: 1rem;
    }

    .module-header {
      flex-direction: column;
      text-align: center;
      gap: 0.75rem;
      padding: 1.25rem;
    }

    .module-icon {
      width: 44px;
      height: 44px;
      font-size: 1.125rem;
      margin-top: 0;
    }

    .module-title {
      font-size: 1.375rem;
    }

    .module-subtitle {
      font-size: 0.875rem;
    }

    .game-module,
    .info-module {
      margin-bottom: 2.5rem;
    }

    .tips-grid {
      grid-template-columns: 1fr;
    }

    .skills-grid {
      grid-template-columns: 1fr;
    }

    .tip-item,
    .skill-item {
      padding: 1rem;
      gap: 0.75rem;
    }
    
    .tip-icon,
    .skill-icon {
      width: 28px;
      height: 28px;
      font-size: 0.75rem;
    }

    .tip-title,
    .skill-title {
      font-size: 0.875rem;
    }

    .tip-text,
    .skill-description {
      font-size: 0.75rem;
    }
  }

  @media (max-width: 640px) {
    .page-header {
      padding: 1.25rem;
      border-radius: 16px;
    }

    .header-content {
      gap: 1rem;
    }

    .page-title {
      font-size: 1.75rem;
    }

    .category-icon {
      width: 56px;
      height: 56px;
    }

    .icon-background {
      width: 56px;
      height: 56px;
      font-size: 1.5rem;
      border-radius: 16px;
    }

    .icon-background::after {
      inset: 2px;
      border-radius: 14px;
    }

    .page-description {
      font-size: 0.95rem;
    }

    .module-title {
      font-size: 1.25rem;
    }

    .module-header {
      padding: 1rem;
    }

    .tip-item,
    .skill-item {
      padding: 0.875rem;
    }
  }
</style>

