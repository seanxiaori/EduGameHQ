# ğŸš€ ä¸‹ä¸€æ­¥ï¼šå®ç°çœŸå®çˆ¬è™«é€»è¾‘

## ğŸ“‹ å½“å‰çŠ¶æ€

âœ… **å·²å®Œæˆ**ï¼š
- GitHub Actionså·¥ä½œæµ âœ…
- æ™ºèƒ½çˆ¬è™«æ¡†æ¶ âœ…
- è´¨é‡è¯„ä¼°ç³»ç»Ÿ âœ…
- å»é‡æ£€æµ‹å·¥å…· âœ…
- é…ç½®ç®¡ç† âœ…
- PRè‡ªåŠ¨åŒ– âœ…
- å®Œæ•´æ–‡æ¡£ âœ…

â³ **å¾…å®Œæˆ**ï¼š
- å®ç°çœŸå®çš„çˆ¬è™«é€»è¾‘
- æµ‹è¯•å®Œæ•´æµç¨‹
- é¦–æ¬¡æˆåŠŸè¿è¡Œ

---

## ğŸ¯ éœ€è¦å®ç°çš„åŠŸèƒ½

### æ ¸å¿ƒä»»åŠ¡

åœ¨ `scripts/intelligent-game-crawler.mjs` ä¸­ï¼Œæœ‰ä¸¤ä¸ªçˆ¬è™«å‡½æ•°éœ€è¦å®ç°ï¼š

1. **crawlCrazyGames** (ä¼˜å…ˆçº§é«˜)
2. **crawlCoolMathGames** (å¯é€‰)

---

## ğŸ’» å®ç°æ–¹æ¡ˆ

### æ–¹æ¡ˆAï¼šä½¿ç”¨Puppeteerï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… å¯ä»¥æ‰§è¡ŒJavaScript
- âœ… å¤„ç†åŠ¨æ€åŠ è½½å†…å®¹
- âœ… æ¨¡æ‹ŸçœŸå®æµè§ˆå™¨è¡Œä¸º
- âœ… é¡¹ç›®å·²å®‰è£…

**ä»£ç ç¤ºä¾‹**ï¼š

```javascript
import puppeteer from 'puppeteer';

async function crawlCrazyGames(categoryConfig) {
  console.log('ğŸ•·ï¸ çˆ¬å– CrazyGames...');
  
  const games = [];
  const browser = await puppeteer.launch({
    headless: true,
    args: ['--no-sandbox', '--disable-setuid-sandbox']
  });
  
  try {
    const page = await browser.newPage();
    
    // è®¾ç½®User-Agent
    await page.setUserAgent('Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36');
    
    // éå†é…ç½®çš„åˆ†ç±»
    for (const [category, path] of Object.entries(categoryConfig.categories)) {
      console.log(`   ğŸ“ çˆ¬å–åˆ†ç±»: ${category}`);
      
      const url = categoryConfig.baseUrl + path;
      await page.goto(url, { waitUntil: 'networkidle2', timeout: 30000 });
      
      // æå–æ¸¸æˆæ•°æ®
      const categoryGames = await page.evaluate((cat) => {
        const gameElements = document.querySelectorAll('.game-item'); // æ ¹æ®å®é™…DOMè°ƒæ•´
        const games = [];
        
        gameElements.forEach(el => {
          try {
            const title = el.querySelector('.game-title')?.textContent?.trim();
            const iframeUrl = el.querySelector('a')?.href;
            const thumbnailUrl = el.querySelector('img')?.src;
            const description = el.querySelector('.game-description')?.textContent?.trim();
            
            if (title && iframeUrl) {
              games.push({
                title,
                iframeUrl: iframeUrl.replace('/game/', '/embed/'), // è½¬æ¢ä¸ºembed URL
                thumbnailUrl,
                description,
                category: cat,
                categoryName: cat.charAt(0).toUpperCase() + cat.slice(1),
                source: 'CrazyGames',
                sourceUrl: iframeUrl
              });
            }
          } catch (err) {
            console.error('è§£ææ¸¸æˆå¤±è´¥:', err);
          }
        });
        
        return games;
      }, category);
      
      games.push(...categoryGames);
      console.log(`   âœ… å‘ç° ${categoryGames.length} ä¸ªæ¸¸æˆ`);
      
      // å»¶è¿Ÿï¼Œé¿å…è¯·æ±‚è¿‡å¿«
      await new Promise(resolve => setTimeout(resolve, 2000));
      
      // åº”ç”¨é™åˆ¶
      if (games.length >= categoryConfig.limits.gamesPerCategory) {
        break;
      }
    }
    
  } catch (error) {
    console.error('âŒ çˆ¬å–å¤±è´¥:', error.message);
  } finally {
    await browser.close();
  }
  
  return games;
}
```

### æ–¹æ¡ˆBï¼šä½¿ç”¨Cheerio + Axiosï¼ˆè½»é‡çº§ï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… æ›´å¿«é€Ÿ
- âœ… èµ„æºæ¶ˆè€—å°‘
- âœ… é€‚åˆé™æ€é¡µé¢

**ç¼ºç‚¹**ï¼š
- âŒ ä¸èƒ½æ‰§è¡ŒJavaScript
- âŒ ä¸é€‚åˆåŠ¨æ€åŠ è½½çš„é¡µé¢

**ä»£ç ç¤ºä¾‹**ï¼š

```javascript
import axios from 'axios';
import * as cheerio from 'cheerio';

async function crawlCrazyGames(categoryConfig) {
  console.log('ğŸ•·ï¸ çˆ¬å– CrazyGames...');
  
  const games = [];
  
  for (const [category, path] of Object.entries(categoryConfig.categories)) {
    try {
      const url = categoryConfig.baseUrl + path;
      const response = await axios.get(url, {
        headers: {
          'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36'
        }
      });
      
      const $ = cheerio.load(response.data);
      
      $('.game-item').each((i, el) => {
        const title = $(el).find('.game-title').text().trim();
        const iframeUrl = $(el).find('a').attr('href');
        const thumbnailUrl = $(el).find('img').attr('src');
        
        if (title && iframeUrl) {
          games.push({
            title,
            iframeUrl: categoryConfig.baseUrl + iframeUrl.replace('/game/', '/embed/'),
            thumbnailUrl,
            category,
            categoryName: category.charAt(0).toUpperCase() + category.slice(1)
          });
        }
      });
      
      await new Promise(resolve => setTimeout(resolve, 2000));
      
    } catch (error) {
      console.error(`çˆ¬å–${category}å¤±è´¥:`, error.message);
    }
  }
  
  return games;
}
```

---

## ğŸ“ å®æ–½æ­¥éª¤

### ç¬¬1æ­¥ï¼šå®‰è£…ä¾èµ–ï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
# Cheerioæ–¹æ¡ˆéœ€è¦é¢å¤–å®‰è£…
npm install cheerio axios
```

### ç¬¬2æ­¥ï¼šç ”ç©¶ç›®æ ‡ç½‘ç«™

1. æ‰“å¼€ https://www.crazygames.com/c/math
2. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
3. æŸ¥çœ‹æ¸¸æˆåˆ—è¡¨çš„DOMç»“æ„
4. æ‰¾åˆ°æ¸¸æˆå¡ç‰‡çš„CSSé€‰æ‹©å™¨
5. ç¡®å®šå¦‚ä½•æå–ï¼š
   - æ¸¸æˆæ ‡é¢˜
   - æ¸¸æˆé“¾æ¥
   - ç¼©ç•¥å›¾
   - è¯„åˆ†
   - æ’­æ”¾æ¬¡æ•°

### ç¬¬3æ­¥ï¼šä¿®æ”¹çˆ¬è™«ä»£ç 

åœ¨ `scripts/intelligent-game-crawler.mjs` ä¸­æ‰¾åˆ°ï¼š

```javascript
async function crawlCrazyGames(categoryConfig) {
  console.log('ğŸ•·ï¸ çˆ¬å– CrazyGames...');
  
  const mockGames = []; // <-- åˆ é™¤è¿™è¡Œ
  
  console.log('   â„¹ï¸ æ³¨æ„ï¼šå½“å‰ä¸ºæ¼”ç¤ºæ¨¡å¼ï¼Œéœ€è¦å®ç°çœŸå®çˆ¬è™«é€»è¾‘'); // <-- åˆ é™¤è¿™è¡Œ
  
  return mockGames; // <-- åˆ é™¤è¿™è¡Œ
}
```

æ›¿æ¢ä¸ºä¸Šé¢çš„çœŸå®å®ç°ã€‚

### ç¬¬4æ­¥ï¼šæœ¬åœ°æµ‹è¯•

```bash
# è¿è¡Œçˆ¬è™«
node scripts/intelligent-game-crawler.mjs

# æ£€æŸ¥ç»“æœ
# å¦‚æœæˆåŠŸï¼Œä¼šç”Ÿæˆï¼š
# - scripts/temp/new-games.json
# - scripts/temp/pr-body.md
```

### ç¬¬5æ­¥ï¼šè°ƒè¯•å’Œä¼˜åŒ–

å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼š

**é—®é¢˜1ï¼šæ‰¾ä¸åˆ°æ¸¸æˆå…ƒç´ **
```javascript
// è°ƒè¯•ä»£ç 
const html = await page.content();
console.log(html); // æŸ¥çœ‹å®Œæ•´HTML
```

**é—®é¢˜2ï¼šè¶…æ—¶**
```javascript
await page.goto(url, { 
  waitUntil: 'domcontentloaded', // æ”¹ä¸ºæ›´å¿«çš„ç­‰å¾…ç­–ç•¥
  timeout: 60000 
});
```

**é—®é¢˜3ï¼šåçˆ¬è™«**
```javascript
// è®¾ç½®æ›´çœŸå®çš„æµè§ˆå™¨ç¯å¢ƒ
await page.setExtraHTTPHeaders({
  'Accept-Language': 'en-US,en;q=0.9'
});
```

### ç¬¬6æ­¥ï¼šGitHub Actionsæµ‹è¯•

1. æäº¤ä»£ç åˆ°GitHub
2. æ‰‹åŠ¨è§¦å‘Actions
3. æŸ¥çœ‹è¿è¡Œæ—¥å¿—
4. æ£€æŸ¥æ˜¯å¦åˆ›å»ºPR

---

## ğŸ› ï¸ è°ƒè¯•æŠ€å·§

### æˆªå›¾è°ƒè¯•

```javascript
// åœ¨çˆ¬è™«ä¸­æ·»åŠ æˆªå›¾
await page.screenshot({ path: 'debug-screenshot.png' });
```

### æ§åˆ¶å°æ—¥å¿—

```javascript
page.on('console', msg => console.log('æµè§ˆå™¨æ—¥å¿—:', msg.text()));
```

### è¯¦ç»†é”™è¯¯

```javascript
try {
  // çˆ¬è™«ä»£ç 
} catch (error) {
  console.error('è¯¦ç»†é”™è¯¯:', error);
  console.error('å †æ ˆ:', error.stack);
}
```

---

## ğŸ“š å‚è€ƒèµ„æº

### CrazyGames API

æŸ¥çœ‹æ˜¯å¦æœ‰å®˜æ–¹APIï¼š
- https://www.crazygames.com/developers
- å¦‚æœæœ‰APIï¼Œä¼˜å…ˆä½¿ç”¨APIè€Œä¸æ˜¯çˆ¬è™«

### DOMé€‰æ‹©å™¨

å¸¸ç”¨å·¥å…·ï¼š
- Chrome DevTools â†’ Elements â†’ Copy selector
- SelectorGadgetæµè§ˆå™¨æ’ä»¶

### Puppeteeræ–‡æ¡£

- å®˜æ–¹æ–‡æ¡£: https://pptr.dev/
- ç¤ºä¾‹: https://github.com/puppeteer/puppeteer/tree/main/examples

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. éµå®ˆç½‘ç«™è§„åˆ™

- æŸ¥çœ‹å¹¶éµå®ˆ robots.txt
- ä¸è¦è¯·æ±‚è¿‡äºé¢‘ç¹
- å°Šé‡ç½‘ç«™çš„æœåŠ¡æ¡æ¬¾

### 2. é”™è¯¯å¤„ç†

```javascript
// æ¯ä¸ªç½‘ç«™éƒ½è¦try-catch
try {
  const games = await crawlWebsite();
} catch (error) {
  console.error('çˆ¬å–å¤±è´¥ï¼Œç»§ç»­å…¶ä»–æº:', error);
  return []; // è¿”å›ç©ºæ•°ç»„ï¼Œä¸ä¸­æ–­æµç¨‹
}
```

### 3. å»¶è¿Ÿæ§åˆ¶

```javascript
// æ¯æ¬¡è¯·æ±‚é—´éš”2-5ç§’
await delay(2000 + Math.random() * 3000);
```

### 4. æ•°æ®éªŒè¯

```javascript
// ç¡®ä¿å¿…éœ€å­—æ®µå­˜åœ¨
if (!game.title || !game.iframeUrl) {
  console.warn('æ¸¸æˆæ•°æ®ä¸å®Œæ•´ï¼Œè·³è¿‡');
  continue;
}
```

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

å®Œæˆååº”è¯¥èƒ½å¤Ÿï¼š

âœ… æœ¬åœ°è¿è¡Œ `node scripts/intelligent-game-crawler.mjs`
âœ… æˆåŠŸçˆ¬å–è‡³å°‘5ä¸ªæ¸¸æˆ
âœ… ç”Ÿæˆ `scripts/temp/new-games.json`
âœ… æ¸¸æˆæ•°æ®åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µ
âœ… GitHub Actionsèƒ½æˆåŠŸè¿è¡Œ
âœ… è‡ªåŠ¨åˆ›å»ºPR

---

## ğŸ’¡ å¿«é€Ÿå¼€å§‹å»ºè®®

### æœ€å°å¯è¡Œå®ç°

å…ˆå®ç°ä¸€ä¸ªæœ€ç®€å•çš„ç‰ˆæœ¬ï¼š

```javascript
async function crawlCrazyGames(categoryConfig) {
  // ç¡¬ç¼–ç å‡ ä¸ªæ¸¸æˆç”¨äºæµ‹è¯•
  return [
    {
      title: 'Test Math Game',
      iframeUrl: 'https://www.crazygames.com/embed/2048',
      thumbnailUrl: 'https://example.com/thumb.jpg',
      description: 'A test game',
      category: 'math',
      categoryName: 'Math',
      rating: 4.5,
      playCount: 100000,
      technology: 'HTML5',
      mobileSupport: true,
      responsive: true
    }
  ];
}
```

æµ‹è¯•æ•´ä¸ªæµç¨‹èƒ½å¦è·‘é€šï¼Œç„¶åå†å®ç°çœŸå®çˆ¬è™«ã€‚

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°å›°éš¾ï¼š

1. æŸ¥çœ‹Puppeteerç¤ºä¾‹ä»£ç 
2. æ£€æŸ¥ç›®æ ‡ç½‘ç«™çš„DOMç»“æ„
3. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·è°ƒè¯•
4. åˆ›å»ºGitHub Issueæè¿°é—®é¢˜

---

**ç¥å®ç°é¡ºåˆ©ï¼** ğŸš€

å®Œæˆåï¼Œæ•´ä¸ªè‡ªåŠ¨æ¸¸æˆå‘ç°ç³»ç»Ÿå°±å¯ä»¥æŠ•å…¥ä½¿ç”¨äº†ï¼

